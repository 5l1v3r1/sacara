; local vars
local0 EQU -4h
local1 EQU -8h
local2 EQU -0Ch
local3 EQU -10h

; arguments
arg0 EQU 8h
arg1 EQU 0Ch
arg2 EQU 10h
arg3 EQU 14h

; VM stack contants
VM_STACK_SIZE EQU 1024
VM_STACK_VARS_SIZE EQU VM_STACK_SIZE

; flags
SET_VM_OVERFLOW_FLAG EQU 008000000h
CLEAR_VM_OVERFLOW_FLAG EQU 0F7FFFFFFh

SET_VM_CARRY_FLAG EQU 010000000h
CLEAR_VM_CARRY_FLAG EQU 0EFFFFFFFh

SET_VM_ZERO_FLAG EQU 020000000h
CLEAR_VM_ZERO_FLAG EQU 0DFFFFFFFh

SET_VM_SIGN_FLAG EQU 040000000h
CLEAR_VM_SIGN_FLAG EQU 0BFFFFFFFh

; Windows constants
HEAP_ZERO_MEMORY EQU 00000008h
DLL_PROCESS_ATTACH EQU 1h
MEM_COMMIT EQU 00001000h
PAGE_READWRITE EQU 04h
PAGE_EXECUTE_READ EQU 020h
MEM_RELEASE EQU 08000h

; Initial XOR opcode key
INIT_OPCODE_XOR_KEY EQU 05Bh
INIT_OPCODE_HEADER_XOR_KEY EQU 0B5h

; Error codes
VM_HANDLER_NOT_FOUND EQU 0FF000001h ; EAX contains to the offset of the opcode giving the error
LOCAL_VAR_OVERFLOW EQU 0FF000002h